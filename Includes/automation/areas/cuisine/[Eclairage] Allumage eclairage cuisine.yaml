- id: '1622142935364'
  alias: '[Eclairage] Allumage eclairage cuisine '
  description: Allumage cuisine
  trigger:
  - platform: state
    entity_id: binary_sensor.motion_cuisine_hg_zone
    to: 'on'
  - platform: state
    entity_id: binary_sensor.motion_cusine_bd_zone
    to: 'on'
  condition:
  - condition: time
    after: 07:00
    before: '23:30'
  - condition: numeric_state
    entity_id: sensor.illuminance_cuisine_illuminance
    below: '100'
  action:
  - repeat:
      while:
      - condition: or
        conditions:
        - condition: state
          entity_id: binary_sensor.motion_cusine_bd_zone
          state: 'on'
        - condition: state
          state: 'on'
          entity_id: binary_sensor.motion_cuisine_hg_zone
      sequence:
      - service: light.turn_on
        target:
          entity_id:
          - light.color_dimmable_light_3
          - light.cuisine
        data:
          brightness_pct: '{% if (now().hour < 8) %} 10 {% elif (now().hour < 10)
            %} 20 {% elif (now().hour < 21) %} 100 {% elif (now().hour < 22) %} 30
            {% elif (now().hour < 23) or ((now().hour == 23) and (now().minute < 45))
            %} 10 {% else %} 0 {% endif%}'
      - delay:
          hours: 0
          minutes: 1
          seconds: 30
          milliseconds: 0
  - repeat:
      until:
      - condition: and
        conditions:
        - condition: state
          entity_id: binary_sensor.motion_cusine_bd_zone
          state: 'off'
        - condition: state
          state: 'off'
          entity_id: binary_sensor.motion_cuisine_hg_zone
      sequence:
      - service: light.turn_off
        data: {}
        target:
          area_id: cuisine
  mode: restart
